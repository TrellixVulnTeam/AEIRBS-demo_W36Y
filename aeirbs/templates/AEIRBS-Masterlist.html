{% extends 'AEIRBS-Default.html' %}
{% block title %}AEIRBS-Masterlist{% endblock title %}
{% load static %}
{% block body %}

<body>

    <div class="left-padding" id="users">
        <div class="container-fluid userContainer" id="userContainer" style="padding:0 25px 25px 25px;">
            <div class="container-fluid"
                style="background-color: white; padding: 25px; box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3); border-radius: 0px;">

                <div class="row">
                    <!--Page Labels-->
                    <div class="col-7">
                        <h3 id="masterlistLabel"><b><b>ADMIN MASTERLIST</b></b>
                        </h3>
                        <h3 class="hidden" id="addAdminLabel"><b><b>ADD ADMIN</b></b>
                        </h3>

                    </div>

                    <!--Add Admin Button-->
                    {% if request.user.is_superuser %}
                    <div class="col-2">
                        <button type="button" id="addAdminButton" class="btn btn-dark float-right  mt-1">
                            <i class="fas fa-user-plus fa-sm mr-2"></i>Add Admin
                        </button>
                    </div>
                    {% endif %}

                    <!--Search Component-->
                    <div class="col-3 mt-1">
                        <form action="#" method="post">
                            <div class="input-group mb-3" id="searchAdmin">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                </div>
                                <input type="text" class="input form-control" placeholder="Search Admin">
                            </div>
                        </form>
                    </div>
                </div>

                <!--Add Admin Form-->
                <div class="container my-3 hidden" id="addAdminForm"
                    style=" background-color:#EAEDED; padding: 20px; border-radius: 5px; box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3);">

                    <button type="submit" id="cancel-addAdmin" class="btn btn-link text-dark float-left my-2 icon"
                        title="Go Back">
                        <span><i class="fas fa-arrow-left"></i></span>
                    </button>

                    <div class="row my-5">
                        <!--Upload Admin Image-->
                        <div class="col-2 imgUp mt-4">
                            <div class="imagePreview"></div>
                            <label class="btn btn-img btn-sm">
                                Select Image<input type="file" class="uploadFile img" value="Upload Photo"
                                    style="width: 0px;height: 0px;overflow: hidden;">
                            </label>
                        </div>

                        <div class="col-10" style="border-left: 1px solid #343A40;">
                            <form action="{% url 'add_user' %}" method="post">
                                {% csrf_token %}
                                <div class="row">
                                    <!--Dropdown Access Role-->
                                    <div class="col">
                                        <div class="form-group">
                                            <label for="accessRole">Access Role</label>
                                            <select class="form-control" name="accessRole">
                                                <option></option>
                                                <option id="adminRole" value="adminRole">Admin</option>
                                                <option id="superRole" value="superRole">Super Admin</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!--Input Employee ID-->
                                    <div class="col">
                                        <div class="form-group">
                                            <label for="employeeID">Employee ID</label>
                                            <input type="text" class="form-control" id="inputEmployeeID"
                                                name="inputEmployeeID" placeholder="Employee ID">
                                        </div>
                                    </div>

                                    <div class="col">
                                    </div>
                                </div>

                                <!--Input First Name-->
                                <div class="row">
                                    <div class="col">
                                        <div class="form-group">
                                            <label for="firstName">First Name</label>
                                            <input type="text" class="form-control" id="inputFirstName"
                                                name="inputFirstName" placeholder="First Name">
                                        </div>
                                    </div>

                                    <!--Input Middle Name-->
                                    <div class="col">
                                        <div class="form-group">
                                            <label for="middleName">Middle Name</label>
                                            <input type="text" class="form-control" id="inputMiddleName"
                                                name="inputMiddleName" placeholder="Middle Name">
                                        </div>
                                    </div>

                                    <!--Input last Name-->
                                    <div class="col">
                                        <div class="form-group">
                                            <label for="lastName">Last Name</label>
                                            <input type="text" class="form-control" id="inputLastName"
                                                name="inputLastName" placeholder="Last Name">
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <!--Input Job Position-->
                                    <div class="col">
                                        <div class="form-group">
                                            <label for="jobPosition">Company Email</label>
                                            <input type="text" class="form-control" id="inputJobPosition"
                                                name="inputJobPosition" placeholder="Job Position">
                                        </div>
                                    </div>

                                    <!--Input Company Email-->
                                    <div class="col">
                                        <div class="form-group">
                                            <label for="companyEmail">Company Email</label>
                                            <input type="email" class="form-control" id="inputCompanyEmail"
                                                name="inputCompanyEmail" placeholder="Company Email">
                                        </div>
                                    </div>

                                    <!--Input Phone Number-->
                                    <div class="col">
                                        <div class="form-group">
                                            <label for="mobileNumber">Company Email</label>
                                            <input type="text" class="form-control" id="inputMobileNumber"
                                                name="inputMobileNumber" placeholder="Mobile Number">
                                        </div>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-dark float-right btn-sm"
                                    id="submitComponent">Submit</button>
                        </div>

                        </form>
                    </div>

                </div>

                <!--Masterlist Table-->
                <table id="masterlistTable" class="table table-striped table-borderless"
                    style="width:100%; text-align:center; box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3);">
                    <thead class="table-header">
                        <tr>
                            <th></th>
                            <th>Employee ID</th>
                            <th>First Name</th>
                            <th>Middle Name</th>
                            <th>Last Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user in users %}
                        <tr class="table-row table-masterlist" data-username='{{user.username}}'>
                            <td>
                                <input type="checkbox">
                            </td>
                            <td>{{user.username}}</td>
                            <td>{{user.first_name}}</td>
                            <td>{{user.profile.middle_name}}</td>
                            <td>{{user.last_name}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    {% for user in users %}
    <div class="right-padding hidden userDetails" id="userDetails{{user.username}}">
        <div class="container-fluid userDetailsContainer" id="userDetailsContainer"
            style="padding:0 25px 25px 12.5px; ">
            <div class="container-fluid"
                style="background-color: white; padding: 25px; box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3); border-radius: 0px; ">
                <div
                    style="background-color:#343A40; min-height: 45vh; height: auto; box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3); text-align:center; position:relative; ">
                    <button type="submit " class="btn btn-link icon mt-2 mr-2 closeAdmin"
                        data-username='{{user.username}}' id="closeAdmin "
                        style="color:white; position:absolute; right: 0; "><i class="fas fa-times fa-sm "></i></button>
                    <button type="submit" class="btn btn-link icon mt-2 ml-2 hidden cancelEditAdmin" id=" "
                        style="color:white; position:absolute; left: 0;"><i
                            class="fas fa-arrow-left fa-sm"></i></button>

                    <div class="dropdown">
                        <button type="submit " class="btn btn-link icon mt-2 ml-2 userActions" id=" "
                            style="color:white; position:absolute; left: 0;" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false"><i class="fas fa-ellipsis-v fa-sm"></i></button>
                        <div class="dropdown-menu" style="min-width: 5px;" aria-labelledby="userActions">
                            <button class="dropdown-item editAdmin" type="button"><i
                                    class="fas fa-user-edit fa-sm mr-2 "></i>Edit</button>
                            {% if request.user.is_superuser %}
                            <form action="{% url 'del_user' %}" method="post">
                                {% csrf_token %}
                                <input type="hidden" class="" name="username" value="{{user.username}}"></input>
                                <button class="dropdown-item" type="submit"><i
                                        class="fas fa-user-times fa-sm mr-2 "></i>Delete</button>
                            </form>
                            {% endif %}
                        </div>

                    </div>
                    <div class="userHeader mb-2" style="padding-top: 6vh;">
                        <div class="mb-3">
                            <img src="{{ user.profile.user_image.url }}"
                                style="border-radius: 50%; height:20vh; border: 8px solid white;box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3) ">
                        </div>

                        <div id="adminDetails " class="" style="color: white; ">
                            <h3><b>{{user.first_name}} {{user.profile.middle_name}} {{user.last_name}}</b></h3>
                            <div class="mt-2 ">
                                <h6><i class="fas fa-user fa-sm mr-2 "></i>{% if user.is_superuser%} Super- Admin
                                    {% else %} Admin {% endif %}</h6>
                                <h6><i class="fas fa-envelope fa-sm mr-2 "></i>{{user.email}}</h6>
                            </div>
                        </div>
                    </div>

                    <!-- Form for Updating user -->
                    {% if request.user.is_superuser %}
                    <form action="{% url 'edit_user' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="username" value="{{ user.username }}">
                        <div id="adminForm " class="mr-4 ml-4 mb-4 adminForm hidden"
                            style="color: white; text-align: left; padding-top: 8vh;">
                            <div class="form-group ">
                                <label for="employeeID ">Employee ID</label>
                                <input type="text" class="form-control " name="employeeID " value="{{user.username}}"
                                    placeholder=" ">
                            </div>
                            <div class="form-group ">
                                <label for="accessRole ">Access Role</label>
                                <select class="form-control " name="accessRole">
                                    {% if user.is_superuser %}
                                    <option></option>
                                    <option id=" adminRole " value="adminRole">Admin</option>
                                    <option id="superRole " value="superRole" selected>Super Admin</option>
                                    {% else %}
                                    <option></option>
                                    <option id="adminRole" value="adminRole" selected>Admin</option>
                                    <option id="superRole" value="superRole">Super Admin</option>
                                    {% endif %}
                                </select>
                            </div>
                            <div class="form-group ">
                                <label for="firstName ">First Name</label>
                                <input type="text " class="form-control " name="firstName" value="{{user.first_name}}"
                                    placeholder=" ">
                            </div>
                            <div class="form-group ">
                                <label for="middleName ">Middle Name</label>
                                <input type="text " class="form-control " name="middleName"
                                    value="{{user.profile.middle_name}}" placeholder=" ">
                            </div>
                            <div class="form-group ">
                                <label for="lastName ">Last Name</label>
                                <input type="text " class="form-control " name="lastName" value="{{user.last_name}}"
                                    placeholder=" ">
                            </div>
                            <div class="form-group ">
                                <label for="companyEmail ">Company Email</label>
                                <input type="email " class="form-control " name="companyEmail" value="{{user.email}}"
                                    placeholder=" ">
                            </div>
                            <div class="form-group ">
                                <label for="jobPosition ">Job Position</label>
                                <input type="text " class="form-control " name="jobPosition"
                                    value="{{user.profile.job_title}}" placeholder=" ">
                            </div>
                            <div class="form-group ">
                                <label for="mobileNumber ">Mobile Number</label>
                                <input type="number " class="form-control " name="mobileNumber"
                                    value="{{user.profile.phone_number}}" placeholder=" ">
                            </div>
                            <button type="submit" class="btn btn-success btn-sm mr-3 saveAdmin hidden" id="saveAdmin"
                                style="position:absolute; right: 0; "><i
                                    class="fas fa-save fa-sm mr-2 "></i>Save</button>
                            <br><br>
                        </div>
                    </form>
                    {% endif %}
                </div>
                <div class=" mt-3 "
                    style="background-color:#EAEDED; padding: 15px; min-height: 30vh; height: auto;box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3);">
                    <h6><b>Recent Activities:</b></h6>
                    <div style=" max-height: 50vh; overflow-y: scroll; border: 1px solid #343A40">
                        <table id="" class="table" style="width:100%; text-align:center;">

                            <tr style="font-size: 14px;">
                                <th>
                                    Activity
                                </th>
                                <th>Date and Time</th>
                            </tr>

                            <tbody>
                                {% for log in logs %}
                                {% if log.0 == user.username%}
                                <tr style="font-size: 12px;">
                                    <td>{{log.1}}</td>
                                    <td>{{log.2}}</td>
                                </tr>
                                {%endif%}
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</body>
<script>

</script>

{% endblock body %}